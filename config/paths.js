import * as fs from 'fs-extra';
import {
  getNormalizedAcceleratorConfig,
} from '../src/configuration/getNormalizedAcceleratorConfig';
import * as path from 'path';

// Make sure any symlinks in the project folder are resolved:
// https://github.com/facebook/create-react-app/issues/637
const appDirectory = fs.realpathSync(process.cwd());
const resolveApp = (relativePath) => path.resolve(appDirectory, relativePath);

const { publicUrl } = getNormalizedAcceleratorConfig();

export const paths = {
  publicUrl,
  moduleFileExtensions: [
    'js',
    'jsx',
    'mjs',
    'ts',
    'tsx',
    'json',
  ],

  appBuild: resolveApp('build-web/'),
  appIndex: resolveApp('src/index.tsx'),
  appNodeModules: resolveApp('node_modules/'),
  appPackageJson: resolveApp('package.json'),
  appPath: resolveApp('.'),
  appPublic: resolveApp('public'),
  appSrc: resolveApp('src/'),
  appTsConfig: resolveApp('tsconfig.json'),
  acceleratorConfig: resolveApp('accelerator.config.js'),
  fontFaceObserverTemplate: resolveApp('templates/fontFaceObserver.hbs'),
  fontLoaderTemplate: resolveApp('templates/fontLoader.hbs'),
  footersSrc: resolveApp('footers/'),
  headersSrc: resolveApp('headers/'),
  htmlTemplate: resolveApp('templates/index.hbs'),
  indexHtml: resolveApp('build-web/index.html'),
  passagesSrc: resolveApp('passages/'),
  pluginsSrc: resolveApp('plugins/'),
  proxySetup: resolveApp('src/setupProxy.ts'),
  publicDir: resolveApp('public/'),
  fontsDir: resolveApp('public/fonts/'),
  fontAutogeneratedStyle: resolveApp('public/fonts/autogenerated/fontface-autogen.css'),
  fontsAutogenerationDir: resolveApp('public/fonts/autogenerated/'),
  testsSetup: resolveApp('src/setupTests.ts'),
};
